<!DOCTYPE html>
<html xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <title>Advanced BBS Project</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://kit.fontawesome.com/fdb840a8cc.js" crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
    <style>
        * { font-family: 'Noto Sans KR', sans-serif; }
        a { text-decoration: none; }
        .disabled-link { pointer-events: none; }
    </style>
</head>
<body>
<div th:insert="~{fragments/base :: top}"></div>
<div id="map" style="margin-top: 102px;width: 100%;height:350px;"></div>

<div class="container" style="margin-top: 102px;">
    <div class="row justify-content-end">
        <div class="col-3 col-md-2 col-lg-2 text-end">
            <aside th:fragment="aside" id="markerInfo">
                <!-- 여기에 마커 정보가 표시됩니다 -->
            </aside>
        </div>
    </div>
</div>

<script type="text/javascript" src="http://dapi.kakao.com/v2/maps/sdk.js?appkey=2d2a3af9bbb84f916054050b2f654eae&libraries=services,clusterer"></script>

<script th:inline="javascript">
    /*<![CDATA[*/
    var mapContainer = document.getElementById('map');
    var mapOption = {
        center: new kakao.maps.LatLng(37.57851, 126.97500),
        level: 10,
        mapTypeId : kakao.maps.MapTypeId.HYBRID
    };
    var map = new kakao.maps.Map(mapContainer, mapOption);

    var geocoder = new kakao.maps.services.Geocoder();
    var resultList = /*[[${resultList}]]*/ [];
    var positions = [];

    resultList.forEach(function(result) {
        var latlng = new kakao.maps.LatLng(result.lat, result.lon);
        positions.push({
            latlng: latlng,
            content: result.firstName
        });
    });

    var imageSrc = "https://t1.daumcdn.net/localimg/localimages/07/mapapidoc/markerStar.png";
    var imageSize = new kakao.maps.Size(24, 35);
    var markerImage = new kakao.maps.MarkerImage(imageSrc, imageSize);
    
    positions.forEach(function(position) {
        var marker = new kakao.maps.Marker({
            map: map,
            position: position.latlng,
            title: position.content,
            image: markerImage
        });

        kakao.maps.event.addListener(marker, 'click', function() {
            var markerInfo = document.getElementById('markerInfo');
            markerInfo.innerHTML = '<h5>위도, 경도, 위치정보</h5>' +
                '<ul>' +
                '<li>' + position.latlng.getLat() + ', ' + position.latlng.getLng() + ' - ' + position.content + '</li>' +
                '</ul>';
        });
    });
    /*]]>*/
</script>
<footer th:replace="~{fragments/base :: bottom}"></footer>
</body>
</html>